---
# handlers file for haproxy
- name: Restart rsyslog
  become: true
  ansible.builtin.service:
    name: rsyslog
    state: restarted
  tags: always

- name: Reload haproxy
  become: true
  ansible.builtin.systemd:
    name: haproxy
    state: reloaded
  tags: always

- name: Reload AppArmor
  become: true
  ansible.builtin.service:
    name: apparmor
    state: reloaded
  tags: always

- name: Reload firewalld
  become: true
  ansible.builtin.service:
    name: firewalld
    state: reloaded
  tags: always

- name: Reload keepalived
  become: true
  ansible.builtin.service:
    name: keepalived
    state: reloaded
  tags: always

- name: Reload daemon-coraza
  become: true
  ansible.builtin.service:
    name: "coraza-spoa"
    state: "restarted"
    daemon_reload: true
  tags: always

- name: Restart coraza
  become: true
  ansible.builtin.service:
    name: "coraza-spoa"
    state: "restarted"
  tags: always
